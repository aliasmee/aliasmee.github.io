<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8" />

  
  <title>åœ¨kubernetesä¸­ï¼Œè®©æŸä¸ªnodeæˆä¸ºä¸“å±èŠ‚ç‚¹</title>

  
  





  
  <meta name="author" content="aliasmee" />
  <meta name="description" content="å¦‚ä½•è®©node å»&amp;rdquo;é€‰æ‹©&amp;rdquo;åªæœ‰è°ï¼ˆpodï¼‰èƒ½éƒ¨ç½²åˆ°è‡ªèº«ä¸Šé¢ï¼Ÿçœ‹äº†ä¸‹ç°æœ‰çš„Node Selectorsã€Node Affinityã€Node Taints, ç»è¿‡æ¯”å¯¹ï¼Œå‘ç°Node Taints æ›´é€‚åˆè¿™ç§æƒ…å†µï¼Œä¸‹é¢æ˜¯åˆ†äº«ä¸€ä¸‹å…·ä½“çš„å†…å®¹.

" />

  
  
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@aliasmeee" />
    <meta name="twitter:title" content="åœ¨kubernetesä¸­ï¼Œè®©æŸä¸ªnodeæˆä¸ºä¸“å±èŠ‚ç‚¹" />
    <meta name="twitter:description" content="å¦‚ä½•è®©node å»&amp;rdquo;é€‰æ‹©&amp;rdquo;åªæœ‰è°ï¼ˆpodï¼‰èƒ½éƒ¨ç½²åˆ°è‡ªèº«ä¸Šé¢ï¼Ÿçœ‹äº†ä¸‹ç°æœ‰çš„Node Selectorsã€Node Affinityã€Node Taints, ç»è¿‡æ¯”å¯¹ï¼Œå‘ç°Node Taints æ›´é€‚åˆè¿™ç§æƒ…å†µï¼Œä¸‹é¢æ˜¯åˆ†äº«ä¸€ä¸‹å…·ä½“çš„å†…å®¹.

" />
    <meta name="twitter:image" content="https://aliasmee.github.io/media/posts/let-node-choose-pod-on-kubernetes/cover.png" />
  

  
  <meta property="og:type" content="article" />
  <meta property="og:title" content="åœ¨kubernetesä¸­ï¼Œè®©æŸä¸ªnodeæˆä¸ºä¸“å±èŠ‚ç‚¹" />
  <meta property="og:description" content="å¦‚ä½•è®©node å»&amp;rdquo;é€‰æ‹©&amp;rdquo;åªæœ‰è°ï¼ˆpodï¼‰èƒ½éƒ¨ç½²åˆ°è‡ªèº«ä¸Šé¢ï¼Ÿçœ‹äº†ä¸‹ç°æœ‰çš„Node Selectorsã€Node Affinityã€Node Taints, ç»è¿‡æ¯”å¯¹ï¼Œå‘ç°Node Taints æ›´é€‚åˆè¿™ç§æƒ…å†µï¼Œä¸‹é¢æ˜¯åˆ†äº«ä¸€ä¸‹å…·ä½“çš„å†…å®¹.

" />
  <meta property="og:url" content="https://aliasmee.github.io/post/let-node-choose-pod-on-kubernetes/" />
  <meta property="og:image" content="https://aliasmee.github.io/media/posts/let-node-choose-pod-on-kubernetes/cover.png" />




<meta name="generator" content="Hugo 0.41" />


<link rel="canonical" href="https://aliasmee.github.io/post/let-node-choose-pod-on-kubernetes/" />
<link rel="alternative" href="https://aliasmee.github.io/index.xml" title="aliasmee&#39;s blog " type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />
<meta name="google-site-verification" content="dOpqXJeKRrCfsEkfUcoR0Ys0_e1wZ_-sZi_zoDpoc_c" />






<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="aliasmee&#39;s blog " />
<meta name="msapplication-tooltip" content="aliasmee&#39;s blog " />
<meta name='msapplication-navbutton-color' content="#5fbf5e" />
<meta name="msapplication-TileColor" content="#5fbf5e" />
<meta name="msapplication-TileImage" content="/img/tile-image-windows.png" />
<link rel="icon" href="https://aliasmee.github.io/img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="https://aliasmee.github.io/img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://aliasmee.github.io/img/favicon-32x32.png" />
<link rel="icon" sizes="192x192" href="https://aliasmee.github.io/img/touch-icon-android.png" />
<link rel="apple-touch-icon" href="https://aliasmee.github.io/img/touch-icon-apple.png" />
<link rel="mask-icon" href="https://aliasmee.github.io/img/safari-pinned-tab.svg" color="#5fbf5e" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="https://aliasmee.github.io/css/bundle.ff02473a9a.css" />


  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
        <a title="Go to comments" class="to-comment" href="#disqus_thread"><span class="icon icon-comment"></span></a>
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="https://aliasmee.github.io/img/avatar.jpg" alt="Avatar">
  
  <h2 class="title">aliasmee&#39;s blog </h2>
  
  <p class="subtitle">DevOps | Kubernetes | Docker | Cloud | CICD </p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
            
            
            
              is-active
            ">
            <a href="https://aliasmee.github.io/">æ–‡å­—</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://github.com/aliasmee">GitHub</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://aliasmee.github.io/tags/">Tags</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://aliasmee.github.io/about/">About Me</a>
          </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list">

      
      <li class="social-item">
        <a href="mailto:name@domain.com" title="Email"><span class="icon icon-email"></span></a>
      </li>

      
      <li class="social-item">
        <a href="//github.com/aliasmee" title="GitHub"><span class="icon icon-github"></span></a>
      </li>

      <li class="social-item">
        <a href="//twitter.com/aliasmeee" title="Twitter"><span class="icon icon-twitter"></span></a>
      </li>

      

      

      

      

      

      

      

      

      

      

      

      

      

      <li class="social-item">
        <a href="https://aliasmee.github.io/img/qrcode.jpg" title="Wechat"><span class="icon icon-wechat"></span></a>
      </li>

      <li class="social-item">
        <a href="//www.linkedin.com/in/linkedin_username" title="Linkedin"><span class="icon icon-linkedin"></span></a>
      </li>

      

      

      

      <li class="social-item">
        <a href="https://aliasmee.github.io/index.xml"><span class="icon icon-rss" title="RSS"></span></a>
      </li>

    </ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">åœ¨kubernetesä¸­ï¼Œè®©æŸä¸ªnodeæˆä¸ºä¸“å±èŠ‚ç‚¹</h1>
      <p class="post-meta">@aliasmee Â· Jul 9, 2018 Â· 2 min read</p>
    </header>
    <article class="post-content"><p>å¦‚ä½•è®©node å»&rdquo;é€‰æ‹©&rdquo;åªæœ‰è°ï¼ˆpodï¼‰èƒ½éƒ¨ç½²åˆ°è‡ªèº«ä¸Šé¢ï¼Ÿçœ‹äº†ä¸‹ç°æœ‰çš„<code>Node Selectors</code>ã€<code>Node Affinity</code>ã€<code>Node Taints</code>, ç»è¿‡æ¯”å¯¹ï¼Œå‘ç°<code>Node Taints</code> æ›´é€‚åˆè¿™ç§æƒ…å†µï¼Œä¸‹é¢æ˜¯åˆ†äº«ä¸€ä¸‹å…·ä½“çš„å†…å®¹.</p>

<p></p>

<h3 id="éœ€æ±‚">éœ€æ±‚</h3>

<p>å‰å‡ å¤©æ–°å»ºäº†å‡ ä¸ªnamespaceï¼Œå…¶ä¸­åŒ…æ‹¬æœ‰testç¯å¢ƒï¼Œç°åœ¨æœ‰ä¸ªéœ€æ±‚å°±æ˜¯æƒ³è¦ç»™è¿™ä¸ªtest å‘½åç©ºé—´åŠ å…¥ä¸€å°ä¸“æœ‰ä¸»æœºã€‚å¹¶ä¸”å…¶å®ƒçš„podè°ƒåº¦ä¸èƒ½è¢«æŒ‡æ´¾åˆ°ä¸Šé¢å»ã€‚ä½¿è¿™ä¸ªpodæˆä¸ºä¸“å±ä¸»æœºï¼Œåªå…è®¸æœ‰ç‰¹æ®Šæ ‡å¿—çš„podè¢«è°ƒåº¦åˆ°ä¸Šé¢å»ã€‚</p>

<h3 id="åˆ†æåŠç¡®å®šæ–¹æ¡ˆ">åˆ†æåŠç¡®å®šæ–¹æ¡ˆ</h3>

<p>ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯node selectorsï¼Œå…ˆç»™node è®¾ç½®labelï¼Œç„¶åè®©pod å»æ ¹æ®labelé€‰æ‹©è¦éƒ¨ç½²åˆ°å“ªå°ä¸»æœºä¸Š.
ç»™node è®¾ç½®labelï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl label nodes node_name work_env<span style="color:#f92672">=</span>test</code></pre></div>
<p>åˆ›å»ºpodæ—¶ï¼Œ åœ¨specæ®µè½é‡Œï¼ŒæŒ‡å®šnodeselectorçš„å€¼ï¼Œå¦‚ä¸‹:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">spec:
  containers: 
  - name: ...
    image: ...
  nodeSelector:
    work_env: test</code></pre></div>
<p>è¿™æ ·è™½ç„¶ä¿è¯äº†podä¸€å®šä¼šè¢«è°ƒåº¦åˆ°è¿™ä¸ªå¸¦æœ‰<code>work_env=test</code> labelçš„ä¸»æœºä¸Š, ä½†æ˜¯å…¶å®ƒæ²¡æœ‰åŠ labelçš„podä¹Ÿæœ‰å¯èƒ½è¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹å»ã€‚å¹¶ä¸”å®˜æ–¹è¡¨ç¤º node-selectors åœ¨æœªæ¥å¯èƒ½ä¼šè¢« node affinity æ›¿ä»£ã€‚</p>

<p>ç¬¬äºŒä¸ªå°±æ˜¯ affinityï¼Œaffinity è¿™å—åŒ…å«æœ‰node çš„affinityï¼Œä»¥åŠInter-pod affinityï¼Œè¿™ä¿©å¯¹åº”çš„éƒ½æœ‰ anti-affinityï¼Œè¿™äº›ç›¸æ¯”node selectorsæ¥è¯´ï¼Œæ›´åŠ çš„çµæ´»ï¼Œæ–¹ä¾¿ã€‚å‰è€…æ˜¯æ ¹æ®node ä¸Šçš„label æŒ‡å®šè°ƒåº¦ç­–ç•¥ï¼Œåè€…æ˜¯æ ¹æ®node ä¸Šå·²æœ‰podçš„label æ¥æŒ‡å®šè°ƒåº¦ç­–ç•¥ã€‚</p>

<p>å½“å‰æœ‰2ç§node affinity:</p>

<ul>
<li>requiredDuringSchedulingIgnoredDuringExecution</li>
<li>preferredDuringSchedulingIgnoredDuringExecution</li>
</ul>

<p>å…¶ä¸­ä¸¤è€…çš„åŒºåˆ«åœ¨äºä¸€ä¸ªæ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œä¸€ä¸ªæ˜¯éå¼ºåˆ¶çš„è½¯è¦æ±‚ã€‚å°±åƒnode selector ä¸€æ ·æ ¹æ®æ¡ä»¶å»è°ƒåº¦. ä½†ä¸åŒçš„æ˜¯ï¼Œåˆ¤æ–­çš„è¯­æ³•è¡¨è¾¾å¼å¾ˆä¸°å¯Œã€‚ç›®å‰æ”¯æŒçš„æ“ä½œæœ‰ï¼š<code>In</code>, <code>NotIn</code>, <code>Exists</code>, <code>DoesNotExist</code>, <code>Gt</code>, <code>Lt</code>.
çœ‹åˆ°å®˜æ–¹ä»‹ç»è¯´ï¼Œæœªæ¥å¯èƒ½ä¼šå¢åŠ æ–°çš„é€‰é¡¹ï¼š<code>requiredDuringSchedulingRequiredDuringExecution</code>ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯å½“ä½ çš„pod åœ¨è¿è¡Œæ—¶ï¼ŒNodeä¸Šçš„labelå‘ç”Ÿäº†æ”¹å˜ï¼Œå°†ä¼šé©±é€è¯¥èŠ‚ç‚¹ä¸Šä¸ç°æœ‰labelä¸åŒ¹é…çš„pod.</p>

<p><code>Noteï¼šç›®å‰affinity è¿˜å±äºbetaï¼Œä½†æ˜¯å·²ç»å¯ä»¥ä½¿ç”¨.</code></p>

<p>ä»¥ä¸Šä¸¤ç§çœ‹ä¼¼éƒ½æ˜¯æ ¹æ®pod æ¥é€‰æ‹©nodeï¼Œé‚£æ ·çš„è¯ï¼Œè¦åœ¨æ‰€æœ‰è¦éƒ¨ç½²çš„èµ„æºä¸ŠæŒ‡å®šç›¸å…³çš„labelè°ƒåº¦ç­–ç•¥ã€‚è¿™æ ·æˆ‘è§‰å¾—åˆæœ‰ç‚¹ç¨å¾®éº»çƒ¦äº†ã€‚ç„¶åå°±å‘ç°è¿˜æœ‰ä¸€ç§æ–¹å¼å¯ä»¥æ»¡è¶³ï¼Œè®©nodeå»é€‰æ‹©podã€‚</p>

<p>ç¬¬ä¸‰ä¸ªæ˜¯ <code>Taints and Tolerations</code>, é€šä¿—çš„æ¥è¯´ï¼Œå¯¹åº”nodeæ˜¯ æ±¡æŸ“(taints)ï¼Œå¯¹åº”podæ˜¯èƒ½å®¹å¿çš„ï¼ˆtolerationsï¼‰, å°±åƒæƒ…ä¾£ä¸€æ ·ï¼Œè™½ç„¶ä»–æœ‰ç¼ºç‚¹ï¼Œä½†ä½ èƒ½å®¹å¿ï¼Œè¿™æ ·è¿™ä¸¤äººå°±å¹¸ç¦çš„åœ¨ä¸€èµ·ç”Ÿæ´»äº†ã€‚ğŸ˜‚</p>

<p>å®˜æ–¹ä»‹ç»:</p>

<p><em>Taints and tolerations are a flexible way to steer pods away from nodes or evict pods that shouldnâ€™t be running.</em>
å¹¶ä¸”å®˜æ–¹ç»™äº†å‡ ä¸ªé€‚ç”¨çš„æ¡ˆä¾‹ï¼š</p>

<ul>
<li>ä¸“ç”¨Node</li>
<li>å…·æœ‰ç‰¹æ®Šç¡¬ä»¶é…ç½®çš„Node</li>
<li>åŸºäºtaintå¯¹podè¿›è¡Œé©±é€</li>
</ul>

<p>å¦å¤–å®˜æ–¹è¿˜è¯´äº†ä» kubernetes 1.6 ç‰ˆæœ¬å¼•å…¥äº†è‡ªåŠ¨taint Node çš„åŠŸèƒ½ï¼Œè¿™æ—¶æ‰€æœ‰ä¸æŒ‡å®šTolerationsçš„podï¼Œå³é»˜è®¤çš„podå°†ä¸ä¼šè¢«è°ƒåº¦åˆ°è¯¥Nodeä¸Šï¼Œä»¥ä¸‹æ˜¯å†…ç½®çš„ï¼š</p>

<ul>
<li>node.kubernetes.io/not-ready: èŠ‚ç‚¹å°šæœªå°±ç»ª</li>
<li>node.kubernetes.io/unreachable: èŠ‚ç‚¹ä¸å¯è¾¾ï¼Œå’Œmasteræ´»ç€apiæ§åˆ¶å™¨å¤±å»é€šä¿¡ï¼Œæˆ–å…¶å®ƒé—®é¢˜å¯¼è‡´æ— æ³•è¿æ¥</li>
<li>node.kubernetes.io/out-of-disk: ç£ç›˜ä¸è¶³</li>
<li>node.kubernetes.io/memory-pressureï¼š å†…å­˜æœ‰å‹åŠ› &lt; 100Mi</li>
<li>node.kubernetes.io/disk-pressure: ç£ç›˜æœ‰å‹åŠ› &lt; 10%</li>
<li>node.kubernetes.io/network-unavailableï¼š èŠ‚ç‚¹çš„ç½‘ç»œä¸å¯ç”¨</li>
<li>node.kubernetes.io/unschedulable: èŠ‚ç‚¹ä¸å¯è°ƒåº¦</li>
<li>node.cloudprovider.kubernetes.io/uninitialized: å½“ä½¿ç”¨â€œå¤–éƒ¨â€äº‘æä¾›ç¨‹åºå¯åŠ¨kubeletæ—¶ï¼Œä¼šåœ¨èŠ‚ç‚¹ä¸Šè®¾ç½®æ­¤taintä»¥å°†å…¶æ ‡è®°ä¸ºä¸å¯ç”¨</li>
</ul>

<p>ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹ç¬¬ä¸‰ç§æ˜¯å¦‚ä½•è®¾ç½®çš„ã€‚</p>

<h3 id="éªŒè¯">éªŒè¯</h3>

<p>ç¬¬ä¸€æ­¥ï¼šæˆ‘ä»¬è¦ç»™ä¸åŒä½œç”¨çš„Node è®¾ç½®ä¸åŒlabelï¼Œè¿™æ ·æ–¹ä¾¿åæœŸç®¡ç†ã€‚è¿™ä¹Ÿæ˜¯åšè¿™äº›äº‹æƒ…çš„å‰æã€‚è¿™é‡Œæˆ‘ä»¬ç”¨äº† taint å’Œ tolerationsï¼Œä¸‹é¢æ˜¯ç»™ä¸»æœºè®¾ç½®taintï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl taint node i-i3i8c9y9 dedicated<span style="color:#f92672">=</span>test:NoSchedule</code></pre></div>
<p>å…¶ä¸­ <code>NoSchedule</code> æ„å‘³ç€ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆ<em>dedicated=test</em> çš„æ±¡ç‚¹çš„å®¹å¿ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„podéƒ½ä¸ä¼šè¢«è°ƒåº¦åˆ°è¯¥Node ä¸Šé¢ã€‚</p>

<p>ç¬¬äºŒæ­¥ï¼šæˆ‘ä»¬ç¼–è¾‘<code>test-taint-pod.yaml</code>ï¼Œåœ¨pod çš„PodSpec ä¸­æŒ‡å®štolerationsï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">spec:
  containers:
  - name: test-taint
    image: ubuntu:latest
    command: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;sleep&#34;</span><span style="color:#f92672">]</span>
    args: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;300&#34;</span><span style="color:#f92672">]</span>
  tolerations:
    - key: <span style="color:#e6db74">&#34;dedicated&#34;</span>
      operator: <span style="color:#e6db74">&#34;Equal&#34;</span>
      value: <span style="color:#e6db74">&#34;test&#34;</span>
      effect: <span style="color:#e6db74">&#34;NoSchedule&#34;</span></code></pre></div>
<p>å¦å¤–<code>operator</code> ä¹Ÿå¯ä»¥æŒ‡å®šä¸º <em>Exists</em> ï¼Œå¦‚æœä½¿ç”¨äº† <em>Exists</em> ï¼Œ<code>value</code> é‚£è¡Œå¯ä»¥å»æ‰ã€‚è¿˜æœ‰ï¼Œå¦‚æœ<code>operator</code> ä¸æŒ‡å®šçš„è¯ï¼Œé»˜è®¤æ˜¯<em>Equal</em></p>

<p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæµ‹è¯•pod</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl create -f test-taint-pod.yaml

<span style="color:#75715e"># ç„¶åæ£€æŸ¥ä¸€ä¸‹
</span><span style="color:#75715e"></span>kubectl get po -o wide</code></pre></div>
<p>é€šè¿‡æ£€æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè®¾ç½®äº†<code>Toleration</code> çš„ podæ€»æ˜¯è¢«è°ƒåˆ°å¯¹åº”æœ‰taint çš„Nodeä¸Šã€‚</p>

<p><code>Tips:</code> è¿™é‡Œæ˜¯å¦‚ä½•ç§»é™¤Node ä¸Šçš„taintæ“ä½œ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl taint nodes i-i3i8c9y9 key:NoSchedule-</code></pre></div>
<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>å›é¡¾ä¸€ä¸‹ï¼Œæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥è®¾ç½®node å’Œpod çš„è°ƒåº¦å…³ç³»ã€‚</p>

<ul>
<li>Node Selectors: ç¬¦åˆPodæŒ‡å®šå¸¦æœ‰labelçš„ä¸»æœºï¼Œå°†ä¼šè¢«è°ƒåº¦ã€‚ä½†æ— æ³•é¿å…å…¶å®ƒPodåœ¨ä¸Šé¢ã€‚å°†ä¼˜å…ˆåˆ†é…ç»™å®šä¹‰äº†åŒ¹é…Node selectorsçš„podã€‚</li>
<li>Affinty: Node äº²å’Œæ€§ï¼Œæœ‰Node selectors çš„æ‰€æœ‰åŠŸèƒ½ï¼Œè¯­æ³•æ›´çµæ´»ã€‚ä½†ä¸€æ ·ï¼Œä¹Ÿæ— æ³•é¿å…å…¶å®ƒPodã€‚</li>
<li>Taint &amp; Toleration: åªæœ‰è®¾ç½®äº† Toleration çš„ä¸»æœºæ‰å¯ä»¥è¢«è°ƒåº¦åˆ°ä¸Šé¢å»ã€‚ä¸»è¦ç”¨é€”æ˜¯è®¾ç½®ä¸ºä¸“ç”¨ä¸»æœºï¼Œæˆ–å…¶å®ƒä¸“æœ‰ç”¨é€”çš„ä¸»æœºã€‚</li>
</ul>

<h3 id="å‚è€ƒ">å‚è€ƒ</h3>

<p><a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/#example-use-cases">å®˜æ–¹ä»‹ç»Taintsä½¿ç”¨æ¡ˆä¾‹</a></p>

<p><a href="https://github.com/kubernetes/kubernetes/blob/0949cefd7b3d9dee314bc8b8e33f9e1d13ce9b40/pkg/scheduler/algorithm/well_known_labels.go">Taints label</a></p>

<p><a href="https://kubernetes.io/docs/tasks/administer-cluster/out-of-resource/#eviction-policy">é©±é€ç­–ç•¥</a></p>

<p><a href="https://embano1.github.io/post/podnodesel/">Understanding and using the Kubernetes PodNodeSelector Admission Controller</a></p>

<p><a href="https://docs.microsoft.com/zh-cn/azure/aks/operator-best-practices-advanced-scheduler">operator-best-practices-advanced-scheduler</a></p></article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="https://aliasmee.github.io/tags/kubernetes"><span class="tag">Kubernetes</span></a></li>
        
          <li><a href="https://aliasmee.github.io/tags/node-selectors"><span class="tag">Node Selectors</span></a></li>
        
          <li><a href="https://aliasmee.github.io/tags/taint-tolerations"><span class="tag">Taint Tolerations</span></a></li>
        
          <li><a href="https://aliasmee.github.io/tags/node-affinity"><span class="tag">Node Affinity</span></a></li>
        
          <li><a href="https://aliasmee.github.io/tags/%E4%B8%93%E7%94%A8node"><span class="tag">ä¸“ç”¨Node</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        Â© This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International Licenseï¼Œplease give source if you wish to quote or reproduce.This post was published <strong>426</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "aliasmee" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    
  </section>
  <footer class="site-footer">
  <p>Â© 2017-2019 aliasmee&#39;s blog </p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

<script src="https://aliasmee.github.io/js/bundle.d1288006cf.js"></script>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-120538012-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>





  </body>
</html>
